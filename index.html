<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>WebRTC Timing Extensions</title>
  <script src="https://www.w3.org/Tools/respec/respec-w3c-common" class="remove"></script>
  <script class='remove'>
  "use strict";
  // See https://github.com/w3c/respec/wiki/ for how to configure ReSpec
  var respecConfig = {
    "doRDFa": false,
    "format": "markdown",
    // "githubAPI": "https://api.github.com/repos/WICG/webrtc-timing",
    // "issueBase": "https://www.github.com/WICG/webrtc-timing/issues/",
    "noLegacyStyle": true,
    "editors": [{
        name: "Henrik Bostr√∂m",
        email: "hbos@google.com",
        company: "Google Inc.",
      },
      {
        name: "Harald Alvestrand",
        email: "hta@google.com",
        company: "Google Inc.",
      },
      // Add additional editors here.
      // https://github.com/w3c/respec/wiki/editors
    ],
    "shortName": "webrtc-timing",
    "specStatus": "CG-DRAFT",
    "subjectPrefix": "[webrtc-timing]",
    // "wg": "WICG",
    "otherLinks": [{
      "key": "Repository",
      "data": [{
        "value": "We are on Github.",
        "href": "https://github.com/henbos/webrtc-timing"
      }, {
        "value": "File a bug.",
        "href": "https://github.com/henbos/webrtc-timing/issues"
      }, {
        "value": "Commit history.",
        "href": "https://github.com/henbos/webrtc-timing/commits/master"
      }, ]
    }],
  };
  </script>
</head>

<body>
  <section id="abstract">
    <p>
      TODO(henbos): Fill in.
    </p>
  </section>
  <section id="sotd">
    <p>
      This is an unofficial proposal.
    </p>
  </section>
  <section id="introduction">
    <h2>Introduction</h2>
    <p>
      TODO(henbos): Fill in.
    </p>
  </section>
  <section id="*">
    <h3>
      <dfn>RTCRtpReceiver</dfn> extensions
    </h3>
    <p>
      Let <code>RTCRtpReceiver</code> objects have an
      <dfn>[[\ReceiverJitterBufferDelayHint]]</dfn> internal slot initially
      initialized to <code>null</code>.
    </p>
    <pre class="idl">partial interface RTCRtpReceiver {
  attribute double? jitterBufferDelayHint;
};</pre>
    <section>
      <h2>Attributes</h2>
      <dl data-link-for="RTCRtpReceiver" data-dfn-for="RTCRtpReceiver"
      class="attributes">
        <dt><code><dfn>jitterBufferDelayHint</dfn></code> of type <span class=
        "idlAttrType"><a>double</a></span>, nullable</dt>
        <dd>
          <p>This attribute affects how much additional delay the system adds
          before decoding and playout delays, by adjusting the length of the
          jitter buffer using a <i>hint</i>. This allows the application to
          influence the tradeoffs between having a longer or shorter jitter
          buffer. The longer the buffer, the more chance there is that packets
          arrive in time for playout, but the higher the delay is. The shorter
          the buffer, the higher the risk of stuttering, but the shorter the
          playout delay. For interactive applications, low delay may be
          important, whereas for passive applications a stutter-free experience
          may be more important.</p>
          <p>Note that the delay is only a hint; a soft target. The user agent
          must attempt to achieve the target by accelerating or decelerating
          media, but it SHOULD NOT distort the media to the point of hurting
          user experience by causing noticeable media distortions such as
          audible speech expansions or video freezes. If the provided hint
          exceeds jitter buffer maximum capacity then user agent will try to
          keep jitter buffer delay close to its maximum capacity</p>
          <p>On getting, this attribute MUST return the value of the
          <a>[[\ReceiverJitterBufferDelayHint]]</a> slot.</p>
          <p>On setting, the user agent MUST run the following steps:</p>
          <ol>
            <li>
              <p>Let <var>receiver</var> be the
              <code><a>RTCRtpReceiver</a></code> object on which the setter is
              invoked.</p>
            </li>
            <li>
              <p>Let <var>delay</var> be the argument to the setter.</p>
            </li>
            <li>
              <p>If <var>delay</var> is negative, <a>throw</a> an
              <code>InvalidAccessError</code> and abort these steps.</p>
            </li>
            <li>
              <p>Set the value of <var>receiver</var>'s
              <a>[[\ReceiverJitterBufferDelayHint]]</a> internal slot to
              <var>delay</var>.</p>
            </li>
            <li>
              <p>In parallel, begin executing the following steps:</p>
              <ol>
                <li>
                  <p>Inform the underlying congestion control mechanism that
                  <var>delay</var> is the new jitter buffer delay hint for
                  this <var>receiver</var>, or that there is no preferences for
                  this <var>receiver</var> if <var>delay</var> is
                  <code>null</code>.</p>
                </li>
              </ol>
            </li>
          </ol>
        </dd>
      </dl>
    </section>
  </section>
</body>
</html>
